{% extends "base.html" %}

{% block title %}
    {{ pro_item.title }}
{% endblock %}
{% block body %}
    <style>
        @media screen and (max-width: 1000px) {
            .product-list {
                flex-direction: column;
            }

            .slider-container2 {
                width: 300px !important;;
            }

            .w-75 {
                width: 90% !important;
            }

            .product-box {
                width: 100%
            }

        }

        .img-wrap {

            max-width: 636px;
            min-width: 300px;
            position: relative;
        {#margin: 20px 0 0 0;#} align-items: center;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            justify-content: center;
        {#transition: opacity .3s;#}
        }

        .img-wrap img {
            border-radius: 8px;
        {#object-fit: cover;#} width: 100%;
        {#height: 50%;#}{#<!-- margin: - 20 % 0 - 10 % 0;#} -->
        }

        .product-list {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center
        }

        .slider-container2 {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 600px;
            border-radius: var(--border-radius-md);
            overflow: auto hidden;
            scroll-snap-type: inline mandatory;
        }

        .slider-item2 {
            margin: 20px 0 0 0;
            position: relative;
            min-width: 100%;
        {#max-height: 600px;#} aspect-ratio: 1 / 1;
            border-radius: var(--border-radius-md);
            overflow: hidden;
            scroll-snap-align: start;
        }


    </style>

    {#    <script>#}
    {#        if (window.history.replaceState) {#}
    {#            window.history.replaceState(null, null, window.location.href);#}
    {#        }#}
    {##}
    {#    </script>#}

    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <li class="alert alert-{{ category }}">
                        {{ message }}
                    </li>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <div class="section product-header">
            <div class="columns">
                <div class="column">
                    <a style="text-decoration:none" href="/">
                        <button type="button" class="btn btn-sm btn-light">
                            <span style="display: flex; align-items:center;" class="menu-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-arrow-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd"
                                  d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"></path>
                        </svg>
                        </span>
                        </button>&nbsp;
                    </a>
                    <span class="title is-4 has-text-muted">{{ pro_item.type_title }}</span>
                    <span class="title is-3 has-text-muted">|</span>
                    <span class="title is-3">{{ pro_item.title }}</span>
                </div>
            </div>
        </div>
        <div class="row align-items-center mt-2">
            <div class="col-lg-6 mb-4">
                <div id="carouselPictures" class="carousel slide"
                     data-bs-ride="carousel">
                    <div class="carousel-inner">

                        {% for all_picture in all_picture %}
                            {% if loop.index == 1 %}
                                <div class="carousel-item active">
                                    <div class="img-wrap">
                                        <img src="{{ all_picture.picture }}"
                                             alt={{ all_picture.picture }}>
                                    </div>
                                </div>
                            {% else %}
                                <div class="carousel-item">
                                    <div class="img-wrap">
                                        <img src="{{ all_picture.picture }}" alt=" ">
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}

                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselPictures"
                                data-bs-slide="prev">
                            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30"
                                 fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
                            </svg>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselPictures"
                                data-bs-slide="next">
                            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30"
                                 fill="currentColor"
                                 class="bi bi-chevron-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"></path>
                            </svg>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 ">
                <div class="card mb-4">
                    <div class="card-body">
                        <span style="text-decoration:none;font-size:20px;font-weight: 600;color: var(--bs-gray-dark)"
                              class="product-title mb-2">
                                {{ pro_item.title }}</span>
                        <br>
                        <!--                        <div class="title is-2">{{pro_item.title}}</div>-->
                        <span style="font-size:26px;font-weight: 600;color: var(--bs-gray-700)">{{ pro_item.price }} ₽</span>
                        <br>
                        <!--                        <p class="title is-3 has-text-muted">{{pro_item.price}} ₽ </p>-->
                        <span>
                            <span style="color: #707f8d;" class="mb-2">Цвет:</span>
                            <span> {{ pro_item.color }}</span>
                        </span>
                        <p></p>
                        <div style="display:flex; margin-left: -5px">
                            {% for item_pic in pro_pic %}
                                <div>

                                    <a href="/product/{{ item_pic.id }}/{{ item_pic.color_id }}">

                                        {% if item_pic.color_id == color_id %}
                                            <div style="margin: 0 5px 0 5px; display: flex; width:100px; height:100px; align-items: center; justify-content:center">
                                                <img style="border: 2px solid #6699FF; border-radius: 10px; width:100px; margin:-10%;"
                                                     src="{{ item_pic.picture2 }}"
                                                     alt=" ">
                                            </div>
                                        {% else %}
                                            <div style="display: flex; margin: 0 5px 0 5px; width:100px; height:100px; align-items: center; justify-content:center">
                                                <img style="border: 2px solid #cccccc ; border-radius: 10px; width:100px; margin:-10%;"
                                                     src="{{ item_pic.picture2 }}"
                                                     alt=" ">
                                            </div>
                                        {% endif %}

                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                        <br>
                        {% if session.logged_in == true %}
                            <div>
                                {% if product_in_order == True %}
                                    <a href="/cart">
                                        <button type="button" title="Требуется вход"
                                                class="w-100 btn btn-primary">
                                            Перейти в корзину <br/>
                                        </button>
                                    </a>


                                {% else %}
                                    <form method="POST">
                                        <button type="submit" class="btn btn-danger w-100">В корзину</button>
                                    </form>
                                    <!--                                                    <p id="text_info" style="text-align: center" class="mt-3">{{msg}}</p>-->
                                {% endif %}
                            </div>

                        {% else %}
                            <button disabled type="button" title="Требуется вход" class="btn btn-danger w-100">В корзину
                            </button>
                            <p style="text-align: center;color: #707f8d;" class="mt-3">Требуется вход в аккаунт</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div>
            <h3 style="font-size:22px;" class="sidebar-title">Описание</h3>
            <p>{{ pro_item.description }}</p>
            <table class="table">
                <tbody>
                <tr>
                    <td>
                        <strong>Артикул</strong>
                    </td>
                    <td>{{ pro_item['product.id'] }}</td>
                </tr>
                <tr>
                    <td>
                        <span>Страна</span>
                    </td>
                    <td>{{ pro_item.country }}</td>
                </tr>
                <tr>
                    <td>
                        <span>Материал</span>
                    </td>
                    <td>{{ pro_item.full_material }}</td>
                </tr>
                <tr>
                    <td>
                        <span>Вес</span>
                    </td>
                    <td>{{ pro_item.weight }} кг</td>
                </tr>
                <tr>
                    <td>
                        <span>Общий размер</span>
                    </td>
                    <td>{{ pro_item.overall }}</td>
                </tr>
                <tr>
                    <td>
                        <span>Размер сиденья</span>
                    </td>
                    <td>{{ pro_item.seat }}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}